<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>localStorage JSON Parse Test</title>
</head>
<body>
    <h1>localStorage JSON Parse Test</h1>
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');
        
        function testLocalStorage() {
            // Clear any existing data
            localStorage.removeItem('user');
            
            // Test 1: Parse when user doesn't exist (should not throw error)
            try {
                const userInfoFromStorage = localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null;
                results.innerHTML += '<p style="color: green;">✅ Test 1 PASSED: No error when user doesn\'t exist</p>';
                results.innerHTML += `<p>Result: ${userInfoFromStorage}</p>`;
            } catch (error) {
                results.innerHTML += `<p style="color: red;">❌ Test 1 FAILED: ${error.message}</p>`;
            }
            
            // Test 2: Parse when user exists
            try {
                localStorage.setItem('user', JSON.stringify({ name: 'Test User', role: 'admin' }));
                const userInfoFromStorage = localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null;
                results.innerHTML += '<p style="color: green;">✅ Test 2 PASSED: Successfully parsed existing user</p>';
                results.innerHTML += `<p>Result: ${JSON.stringify(userInfoFromStorage)}</p>`;
            } catch (error) {
                results.innerHTML += `<p style="color: red;">❌ Test 2 FAILED: ${error.message}</p>`;
            }
            
            // Test 3: Parse when user is null (edge case)
            try {
                localStorage.setItem('user', 'null');
                const userInfoFromStorage = localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null;
                results.innerHTML += '<p style="color: green;">✅ Test 3 PASSED: Successfully handled null string</p>';
                results.innerHTML += `<p>Result: ${userInfoFromStorage}</p>`;
            } catch (error) {
                results.innerHTML += `<p style="color: red;">❌ Test 3 FAILED: ${error.message}</p>`;
            }
            
            // Test 4: Parse invalid JSON
            try {
                localStorage.setItem('user', 'invalid json');
                const userInfoFromStorage = localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null;
                results.innerHTML += '<p style="color: red;">❌ Test 4 FAILED: Should have thrown error for invalid JSON</p>';
            } catch (error) {
                results.innerHTML += `<p style="color: green;">✅ Test 4 PASSED: Correctly threw error for invalid JSON: ${error.message}</p>`;
            }
        }
        
        testLocalStorage();
    </script>
</body>
</html>

